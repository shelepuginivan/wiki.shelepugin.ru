---
title: 'IPC'
sidebar:
    label: 'niri msg'
    order: 5
---

Вы можете взаимодействовать с запущенным экземпляром niri через IPC-сокет.
Ознакомьтесь с `niri msg --help` для доступных команд.

Флаг `--json` выведет ответ в формате JSON. Например, `niri msg --json outputs`.

Для программного доступа ознакомьтесь с [подпакетом `niri-ipc`](https://github.com/YaLTeR/niri/wiki/niri-ipc/),
который определяет типизацию. Коммуникация через IPC-сокет осуществляется в JSON-формате.

:::tip

Если после обновления niri msg вы получаете ошибки парсинга, убедитесь, что вы перезапустили сам niri.
Возможно, вы пытаетесь запустить новый niri msg на старом композиторе niri.

:::

## Обратная совместимость

JSON-вывод *должен* оставаться стабильным, т.е.:

- Существующие поля и варианты перечислений (enum'ов) не должны быть переименованы.
- Существующие не опциональные поля не должны быть удалены.

Однако, новые поля и варианты перечислений будут добавляться, поэтому вы не
должны обрабатывать неизвестные поля или варианты строго там, где это
нецелесообразно

Я еще не на 100% уверен в стабильности, потому что пользователей не так много,
и может быть что-то основное, что я упустил в дизайне вывода JSON.

Форматированный/человеко-понятный вывод (т.е. без флага `--json`) **не** является стабильным.
Предпочтительнее использовать вывод в формате JSON в скриптах, т.к. я оставляю за собой право
вносить любые изменения в форматированный вывод.

Подпакет `niri-ipc` (как и другие подпакеты niri) **не** является стабильным с
точки зрения API в рамках семантического версионирования Rust. Вместо этого, он
следует версии самого niri. В частности, новые поля структур и варианты
перечислений будут добавляться.
