---
title: 'Конфигурация: Вывод'
sidebar:
    label: 'Вывод'
    order: 3
---

import { Badge, Steps } from '@astrojs/starlight/components'

По умолчанию, niri попробует включить все подключённые мониторы. Вы можете
отключить или настроить их в блоке `output`.

Следующим образом выглядят все опции:

```kdl
output "eDP-1" {
    // off
    mode "1920x1080@120.030"
    scale 2.0
    transform "90"
    position x=1280 y=0
    variable-refresh-rate
    background-color "#003300"
}

output "HDMI-A-1" {
    // ...настройки для HDMI-A-1...
}
```

Названия устройств вывода соответствуют названиям подключений
(т.е. `eDP-1`, `HDMI-A-1` и т.п.). Вы можете вывести список доступных устройств,
введя команду:

```shell
niri msg outputs
```

Как правило, встроенный монитор ноутбука будет назван `eDP-1`.
Сопоставление по производителю и модели выхода планируется, но заблокировано
при использовании Smithay `libdisplay-info` вместо `edid-rs`.

<Badge text="С версии 0.1.6" variant="tip"/> Названия устройств вывода
регистро-независимы.

## Опции

### `off`

Этот флаг выключает устройство вывода полностью.

```kdl
// Выключить этот монитор.
output "HDMI-A-1" {
    off
}
```

### `mode`

Устанавливает разрешение и частоту обновлений монитора.

Формат имеет вид: `<ширина>x<высота>` или `<ширина>x<высота>@<частота обновлений>`.

Если `mode` пропущен или не работает, niri попытается установить опцию автоматически.

Запустите

```shell
niri msg outputs
```

из сессии niri, чтобы вывести список устройств вывода и их моды. Частота
обновлений, которую вы можете указать для монитора, должна *полностью*
совпадать вплоть до трех десятичных цифр, с тем, что вы видите в выводе
команды `niri msg outputs`.

```kdl
// Установить частоту обновлений для монитора.
// Высокочастотные мониторы часто используют 60 Гц в качестве предпочтительного
// режима, поэтому нужно установить частоту вручную.
output "HDMI-A-1" {
    mode "2560x1440@143.912"
}

// Использование меньшего разрешения для встроенного монитора
// ноутбука (например, для теста).
output "eDP-1" {
    mode "1280x720"
}
```

### `scale`

Устанавливает масштабирование монитора.

<Badge text="С версии 0.1.6" variant="tip"/> Если масштаб не задан, niri
определит подходящий масштаб, основываясь на физических размерах и разрешении
монитора.

<Badge text="С версии 0.1.7" variant="tip"/> Вы можете использовать дробные
значения, например, `scale 1.5` для масштаба 150%.

<Badge text="С версии 0.1.7" variant="tip"/> Точка больше не нужна для
целочисленных значений, например, можно использовать `scale 2` вместо
`scale 2.0`.

<Badge text="С версии 0.1.7" variant="tip"/> Значения менее 0 и более 10
приводят к ошибке парсинга конфигурации. Ранее масштаб все равно был привязан к
этим значениям.

```kdl
output "eDP-1" {
    scale 2.0
}
```

### `transform`

Повернуть вывод против часовой стрелки.

Опция может принимать значения:

-   `"normal"`
-   `"90"`
-   `"180"`
-   `"270"`
-   `"flipped"`
-   `"flipped-90"`
-   `"flipped-180"`
-   `"flipped-270"`

Значения с `flipped` дополнительно отзеркалят вывод.

```kdl
output "HDMI-A-1" {
    transform "90"
}
```

### `position`

Устанавливает позицию вывода в глобальной системе координат.

Это затрагивает направленные действия с мониторами, такие как `focus-monitor-left`,
а также перемещение курсора, который может перемещаться только между двумя
непосредственно соседними мониторами.

:::note

При позиционировании необходимо учитывать масштаб и поворот вывода: размеры
вывода определяются в логических, или масштабных, пикселях. Например, вывод
3840×2160 с масштабом 2.0 будет иметь логический размер 1920×1080, поэтому,
чтобы поместить другой вывод, непосредственно примыкающий к нему справа,
установите его x равным 1920. Если позиция не задана или приводит к перекрытию,
вывод размещается автоматически.

:::

```kdl
output "HDMI-A-1" {
    position x=1280 y=0
}
```

#### Автоматическое позиционирование

Niri заново позиционирует выводы при каждом изменении конфигурации выводов
(включая подключение и отключение мониторов). Для позиционирования используется
следующий алгоритм:

<Steps>

1.  Собрать информацию о всех подключённых мониторах и их логических размерах.
2.  Отсортировать их по именам. Это обеспечивает, что автоматическое
    позиционирование не зависит от порядка подключения мониторов. Это важно,
    ведь при запуске композитора порядок подключения не является строго
    определённым.
3.  Попытаться расположить мониторы в соответствии с явно указанными опциями
    `position`, в установленном порядке. Если один монитор перекрывает предыдущий,
    разместить его справа от всех ранее расположенных. В этом случае также будет
    выведено предупреждение.
4.  Расположить все остальные мониторы, для которых опция `position` не указано
    явно, разместив их правее всех ранее расположенных мониторов.

</Steps>

### `variable-refresh-rate` <Badge text="С версии 0.1.5" variant="tip"/>

Этот флаг включает переменную частоту обновлений (VRR, или адаптивную
синхронизацию, а также FreeSync или G-Sync) в том случае, если монитор
поддерживает её.

Вы можете проверить, поддерживается ли данная опция, запустив команду:

```shell
niri msg outputs
```

:::note

Некоторые драйвера имеют проблемы с VRR.

Если при использовании VRR курсор движется с низкой частотой кадров, попробуйте
установить флаг [отладки](/niri/configuration/debug) `disable-cursor-plane` и
снова подключить монитор.

Если монитор не определяется как VRR-совместимый, когда он должен быть, иногда
отсоединение другого монитора исправляет ситуацию.

Некоторые мониторы при включенном VRR постоянно меняют режим (мигают
черным); я не уверен, есть ли способ это исправить.

:::

```kdl
output "HDMI-A-1" {
    variable-refresh-rate
}
```

### `background-color` <Badge text="С версии 0.1.8" variant="tip"/>

Устанавливает цвет фона, который niri отображает для данного вывода.
Этот цвет виден в том случае, когда не используются какие-либо утилиты для
заднего фона, такие как `swaybg`.

Альфа-канал этого цвета игнорируется.

```kdl
output "HDMI-A-1" {
    background-color "#003300"
}
```
